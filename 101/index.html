<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Episode 101 — Script</title>

  <style>
    html, body { height: 100%; margin: 0; background: #0b0b0b; }

    iframe {
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      border: 0;
      display: block;
      background: #0b0b0b;
    }

    .dl-wrap {
      position: fixed;
      top: 14px;
      right: 14px;
      z-index: 10;
    }

    .dl {
      width: 42px;
      height: 42px;
      display: grid;
      place-items: center;
      border-radius: 12px;
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.12);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      color: rgba(255,255,255,.85);
      text-decoration: none;
      transition: background 120ms ease, border-color 120ms ease, transform 80ms ease;
      -webkit-tap-highlight-color: transparent;
      outline: none;
    }

    .dl:hover { background: rgba(0,0,0,.35); border-color: rgba(255,255,255,.18); }
    .dl:active { transform: translateY(1px); }
    .dl svg { width: 18px; height: 18px; display: block; }

    /* Tooltip forced OFF so it cannot be the culprit */
    .tip { display: none !important; }

    /* Fallback (auto-hides after load) */
    .fallback {
      position: fixed;
      left: 14px;
      bottom: 14px;
      font: 13px/1.3 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: rgba(255,255,255,.72);
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.10);
      padding: 10px 12px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: 10;

      opacity: 1;
      transform: translateY(0);
      transition: opacity 220ms ease, transform 220ms ease;
    }

    .fallback a {
      color: rgba(255,255,255,.9);
      text-decoration: underline;
      text-underline-offset: 3px;
    }

    .fallback.is-hidden {
      opacity: 0;
      transform: translateY(6px);
      pointer-events: none;
    }

    /* ===== DEBUG OVERLAY (TEMPORARY) ===== */
    #debugHUD {
      position: fixed;
      left: 12px;
      top: 12px;
      z-index: 99999;
      max-width: calc(100vw - 24px);
      font: 12px/1.3 system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: rgba(255,255,255,.95);
      background: rgba(0,0,0,.65);
      border: 1px solid rgba(255,255,255,.18);
      padding: 10px 12px;
      border-radius: 12px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      pointer-events: none;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .debug-outline {
      outline: 2px solid rgba(255,0,190,.95) !important;
      outline-offset: 2px !important;
    }
    /* ==================================== */
  </style>
</head>

<body>

  <iframe
    id="viewer"
    src="https://drive.google.com/file/d/1hcqX2bd-8A5ljpYoEaoJ-6db4F4Z1HZZ/preview"
    allow="fullscreen">
  </iframe>

  <div class="dl-wrap" id="dlWrap">
    <a
      class="dl"
      href="https://drive.google.com/uc?export=download&id=1hcqX2bd-8A5ljpYoEaoJ-6db4F4Z1HZZ"
      aria-label="Download PDF">
      <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 3v10" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
        <path d="M8 11l4 4 4-4" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M5 20h14" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
      </svg>
    </a>
    <div class="tip">Download PDF</div>
  </div>

  <div id="fallback" class="fallback">
    If the script doesn’t load,
    <a href="https://drive.google.com/file/d/1hcqX2bd-8A5ljpYoEaoJ-6db4F4Z1HZZ/preview" target="_blank" rel="noopener">
      open it here
    </a>.
  </div>

  <div id="debugHUD">Debug active…</div>

  <script>
    (function () {
      const viewer = document.getElementById("viewer");
      const fb = document.getElementById("fallback");

      viewer.addEventListener("load", () => {
        setTimeout(() => fb.classList.add("is-hidden"), 600);
      });

      // ===== DEBUG: identify whatever is drawing the "extra box" =====
      const hud = document.getElementById("debugHUD");

      function describe(el) {
        if (!el) return "(none)";
        const cls = el.className && typeof el.className === "string" ? "." + el.className.trim().split(/\s+/).join(".") : "";
        const id = el.id ? "#" + el.id : "";
        return `<${el.tagName.toLowerCase()}${id}${cls}>`;
      }

      function clearOutlines() {
        document.querySelectorAll(".debug-outline").forEach(n => n.classList.remove("debug-outline"));
      }

      function scan() {
        // Points: center of download button, and the area just below it where the ghost box appears
        const x = window.innerWidth - 35;
        const y1 = 35;
        const y2 = 85;

        const s1 = document.elementsFromPoint(x, y1);
        const s2 = document.elementsFromPoint(x, y2);

        clearOutlines();

        const targets = (s2 || []).slice(0, 4);
        targets.forEach(el => el.classList.add("debug-outline"));

        hud.textContent =
          `X-RAY\n` +
          `On button @ (${x}, ${y1}):\n  1) ${describe(s1 && s1[0])}\n  2) ${describe(s1 && s1[1])}\n\n` +
          `Below button @ (${x}, ${y2}):\n  1) ${describe(s2 && s2[0])}\n  2) ${describe(s2 && s2[1])}\n  3) ${describe(s2 && s2[2])}\n  4) ${describe(s2 && s2[3])}\n\n` +
          `Take a screenshot with the pink outline visible.`;
      }

      scan();
      window.addEventListener("scroll", scan, { passive: true });
      window.addEventListener("resize", scan);
      // ===== END DEBUG =====
    })();
  </script>

</body>
</html>
